# ğŸ§ª app.py ì‹¤í–‰ ë° ê²€ì¦ ê¸°ë¡ â€” 2025-10-24

>> ğŸ“… **ì‘ì„±ì¼:** 2025-10-24  
>> âœï¸ **ì‘ì„±ì:** Jay (@jjaayy2222)  
>>ğŸ“‚ **íŒŒì¼ ê²½ë¡œ:** `flownote-mvp/app.py`

---

## ğŸ¯ 1. ëª©ì 

`app.py`ëŠ” **FlowNote MVP**ì˜ í•µì‹¬ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ,  
Streamlit ê¸°ë°˜ì˜ **íŒŒì¼ ì—…ë¡œë“œ â†’ ì²­í‚¹ â†’ ì„ë² ë”© â†’ ê²€ìƒ‰** íŒŒì´í”„ë¼ì¸ì„ ì™„ì„±í•¨.  

ì´ë²ˆ ì‹¤ìŠµì˜ ëª©ì ì€ ë‹¤ìŒê³¼ ê°™ë‹¤:

- Streamlit UI êµ¬ì„± ë° ì™„ì„±ë„ ê²€ì¦  
- FAISS ê¸°ë°˜ ë²¡í„° ê²€ìƒ‰ ë¡œì§ ì •ìƒ ë™ì‘ í™•ì¸  
- ì „ì²´ ë°ì´í„° íë¦„(ì—…ë¡œë“œ â†’ ì²˜ë¦¬ â†’ ê²€ìƒ‰)ì˜ ìë™í™” ê²€ì¦  
- MVP ìˆ˜ì¤€ì˜ ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ ì™„ì„±

<br>

## ğŸ§° 2. í…ŒìŠ¤íŠ¸ í™˜ê²½

| í•­ëª© | ë‚´ìš© |
|------|------|
| Python | `3.11.10` (pyenv) |
| ê°€ìƒí™˜ê²½ | myenv |
| ì£¼ìš” íŒ¨í‚¤ì§€ | `streamlit==1.31.0`, `faiss-cpu==1.8.0`, `numpy==1.26.3`, `langchain==1.0.2`, `langchain-openai==1.0.1`, `python-dotenv==1.1.1` |
| í”„ë¡œì íŠ¸ ê²½ë¡œ | `/flownote-mvp/` |
| ê´€ë ¨ ëª¨ë“ˆ | `backend/utils.py`, `backend/chunking.py`, `backend/embedding.py`, `backend/faiss_search.py` |
| í…ŒìŠ¤íŠ¸ ëª…ë ¹ | `streamlit run app.py` |

<br>

## ğŸ§© 3. ì£¼ìš” êµ¬ì„± ë° ì‹¤ìŠµ ë‚´ìš©

### âœ… 1) í˜ì´ì§€ ì„¤ì •
- Streamlit ê¸°ë³¸ ë ˆì´ì•„ì›ƒ Wide ëª¨ë“œë¡œ ì„¤ì •  

  - ê¸°ë³¸ ë ˆì´ì•„ì›ƒ
  - ![ìƒˆ UI](../../assets/figures/app_py_test/2025-10-24-app-py-1.png)

  - ë°˜ì‘í˜• ì›¹ í™”ë©´
  - ![ë°˜ì‘í˜• ì›¹ í™”ë©´](../../assets/figures/app_py_test/2025-10-24-app-py-2.png)

<br>

- ì•± íƒ€ì´í‹€ ë° ì•„ì´ì½˜ ì§€ì •  

  - ì•„ì´ì½˜ ì§€ì •
  - ![ì•„ì´ì½˜ ì§€ì •1](../../assets/figures/app_py_test/2025-10-24-app-py-4.png)

  - ì•„ì´ì½˜ ì§€ì •2
  - ![ì•„ì´ì½˜ ì§€ì •2](../../assets/figures/app_py_test/2025-10-24-app-py-5.png)

  - ì•„ì´ì½˜ ì§€ì •3
  - ![ì•„ì´ì½˜ ì§€ì •3](../../assets/figures/app_py_test/2025-10-24-app-py-6.png)

<br>

- ì„¸ì…˜ ìƒíƒœ(`st.session_state`) ì´ˆê¸°í™”  

```python
    st.set_page_config(
        page_title="FlowNote MVP",
        page_icon="ğŸ”",
        layout="wide"
    )
```

* í…ŒìŠ¤íŠ¸ ê²°ê³¼:
  * ì•± ì‹¤í–‰ ì‹œ ë¸Œë¼ìš°ì € ìë™ ì—´ë¦¼ â†’ `http://localhost:8501`
  * íƒ€ì´í‹€ê³¼ ì•„ì´ì½˜ ì •ìƒ ì¶œë ¥ í™•ì¸ **`âœ…`**

<br>

### âœ… 2) íŒŒì¼ ì—…ë¡œë“œ & ì²˜ë¦¬ (ì‚¬ì´ë“œë°”)

- .md, .txt íŒŒì¼ ë‹¤ì¤‘ ì—…ë¡œë“œ ì§€ì›

  - íŒŒì¼ ì—…ë¡œë“œ
  - ![íŒŒì¼ ì—…ë¡œë“œ](../../assets/figures/app_py_test/2025-10-24-app-py-3.png)

  - íŒŒì¼ ì—…ë¡œë“œ2
  - ![íŒŒì¼ ì—…ë¡œë“œ2](../../assets/figures/app_py_test/2025-10-24-app-py-7.png)

<br>

- **`ğŸ“¤ ì—…ë¡œë“œ & ì²˜ë¦¬`** ë²„íŠ¼ í´ë¦­ ì‹œ ë‹¤ìŒ ë‹¨ê³„ ìˆ˜í–‰:
  - â€ `FAISSRetriever` **ì´ˆê¸°í™”**
  - â íŒŒì¼ ë‚´ìš© `UTF-8` **ë””ì½”ë”©**
  - â‚ **`chunk_with_metadata()`** ë¡œ `í…ìŠ¤íŠ¸ ë¶„í• `
  - âƒ **`get_embeddings()`** ë¡œ `ì„ë² ë”© ìƒì„±`
  - â„ **`FAISS ì¸ë±ìŠ¤`ì— ì €ì¥**

<br>

  - ì—…ë¡œë“œ í›„ ì²˜ë¦¬
  - ![ì—…ë¡œë“œ í›„ ì²˜ë¦¬](../../assets/figures/app_py_test/2025-10-24-app-py-8.png)

  - ì—…ë¡œë“œ í›„ ì²˜ë¦¬2
  - ![ì—…ë¡œë“œ í›„ ì²˜ë¦¬2](../../assets/figures/app_py_test/2025-10-24-app-py-9.png)

<br>

- ì²˜ë¦¬ í›„ `í†µê³„` ë° `í† í°`/`ë¹„ìš©` ì¶œë ¥

```python
    chunks = chunk_with_metadata(content, uploaded_file.name)
    embeddings, tokens, cost = get_embeddings(texts)
    st.session_state.retriever.add_documents(texts, all_embeddings, all_chunks)
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼:
  - âœ… 3ê°œ íŒŒì¼ ì—…ë¡œë“œ ë° ì²­í‚¹ ì„±ê³µ (ì´ 4ê°œ ì²­í¬)
  - âœ… ì„ë² ë”© ìƒì„±: 367 í† í° â†’ $0.000007
  - âœ… FAISS ì¸ë±ìŠ¤ ì •ìƒ ë¹Œë“œ
  - âœ… ì´ ë¬¸ì„œ/ì²­í¬ ìˆ˜ í†µê³„ í‘œì‹œ ì •ìƒ ì‘ë™

<br>

### âœ… 3) ê²€ìƒ‰ ê¸°ëŠ¥

- ì‚¬ìš©ìê°€ ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ë©´ **`get_single_embedding()`ìœ¼ë¡œ `ì¿¼ë¦¬ ë²¡í„°` ìƒì„±**
- **`FAISS`ì—ì„œ `ë²¡í„° ìœ ì‚¬ë„ ê²€ìƒ‰` ìˆ˜í–‰**
- **`ìƒìœ„ Nê°œ` ê²°ê³¼** *(top_k)* ë¥¼ `Expander UI`ë¡œ í‘œì‹œ
- **`ìœ ì‚¬ë„`, `íŒŒì¼ëª…`, `ìœ„ì¹˜`, `ë‚´ìš©` ëª¨ë‘ í•¨ê»˜ í‘œì‹œ**

```python
    results = st.session_state.retriever.search(query_embedding, top_k=top_k)
```

<br>

  - ê²€ìƒ‰ ê²°ê³¼
  - ![ê²€ìƒ‰ ê²°ê³¼](../../assets/figures/app_py_test/2025-10-24-app-py-10.png)

  - ê²€ìƒ‰ ê²°ê³¼2 - *ë¬¸ì„œ ì† ë‹¨ì–´ `ë¹„ë™ê¸°ì‹ ì±„íŒ…`ìœ¼ë¡œ ê²€ìƒ‰í•´ë³´ê¸°*
  - ![ê²€ìƒ‰ ê²°ê³¼2](../../assets/figures/app_py_test/2025-10-24-app-py-11.png)

<br>

- í…ŒìŠ¤íŠ¸ ê²°ê³¼:
  - âœ… ê²€ìƒ‰ ì…ë ¥ ì¦‰ì‹œ ë°˜ì‘ (ì•½ 1.3ì´ˆ ë‚´ ê²°ê³¼ ë°˜í™˜)
  - âœ… ê²°ê³¼ ìˆ˜ ì¡°ì ˆ ìŠ¬ë¼ì´ë”(top_k) ì •ìƒ ì‘ë™
  - âœ… ìœ ì‚¬ë„ í‰ê·  40.65% ì´ìƒ
  - âœ… ë‚´ìš© ë° íŒŒì¼ëª… ì¶œë ¥ í˜•ì‹ ì•ˆì •ì 

<br>

### âœ… 4) í†µê³„ ëŒ€ì‹œë³´ë“œ

- ì—…ë¡œë“œëœ íŒŒì¼ ë° ì¸ë±ìŠ¤ í¬ê¸° í‘œì‹œ

- `st.metric()`ì„ ì‚¬ìš©í•´ ì‹œê°ì ìœ¼ë¡œ í†µê³„ í‘œì‹œ

  - ê²€ìƒ‰ ê²°ê³¼3 - `ì‹œê°ì ìœ¼ë¡œ í‘œì‹œ`
  - ![ê²€ìƒ‰ ê²°ê³¼3](../../assets/figures/app_py_test/2025-10-24-app-py-12.png)

<br>

```python
    stats = st.session_state.retriever.get_stats()
    st.metric("ì´ ë¬¸ì„œ", stats['total_documents'])
    st.metric("ì¸ë±ìŠ¤ í¬ê¸°", stats['index_size'])
```

- í…ŒìŠ¤íŠ¸ ê²°ê³¼:
  - ë¬¸ì„œ ìˆ˜, ì¸ë±ìŠ¤ í¬ê¸° ì‹¤ì‹œê°„ ê°±ì‹  í™•ì¸
  - ì‚¬ì´ë“œë°” UI ë ˆì´ì•„ì›ƒ ì •ìƒ ìœ ì§€

<br>

  - `ìƒìœ„ = 1`
  - ![ìƒìœ„=1](../../assets/figures/app_py_test/2025-10-24-app-py-13.png)

  - `ìƒìœ„ = 2`
  - ![ìƒìœ„=2](../../assets/figures/app_py_test/2025-10-24-app-py-14.png)

  - `ìƒìœ„ = 3`
  - ![ìƒìœ„=3](../../assets/figures/app_py_test/2025-10-24-app-py-15.png)

<br>

### âœ… 5) ì´ˆê¸° ì•ˆë‚´ í™”ë©´ (retriever ì—†ìŒ)

- íŒŒì¼ ì—…ë¡œë“œ ì „ ìƒíƒœì—ì„œëŠ” ì‚¬ìš© ì•ˆë‚´ í‘œì‹œ

- ì„¸ ê°€ì§€ ê¸°ëŠ¥(`ì—…ë¡œë“œ`, `ê²€ìƒ‰`, `ë¡œì»¬ ì €ì¥`) ì¹´ë“œ í˜•íƒœë¡œ ì‹œê°í™”

- í…ŒìŠ¤íŠ¸ ê²°ê³¼:
  - UI ì •ìƒ ë Œë”ë§
  - ê° ì„¹ì…˜ ì„¤ëª… ì •í™•í•˜ê²Œ í‘œì‹œ

<br>

## ğŸ§­ 4. Review

| êµ¬ë¶„          | ê²€ì¦ í•­ëª©                          | ê²°ê³¼            |
|--------------|--------------------------------|---------------|
| **`ğŸ“¦ ê¸°ëŠ¥ í†µí•©`**  | íŒŒì¼ `ì—…ë¡œë“œ` â†’ `ì²­í‚¹` â†’ `ì„ë² ë”©` â†’ `ê²€ìƒ‰` â†’ `ì¶œë ¥`    | âœ… ì •ìƒ ì‘ë™       |
| **`ğŸ§  ê²€ìƒ‰ í’ˆì§ˆ`**  | `FAISS ìœ ì‚¬ë„` ê²°ê³¼ ì •í™•ë„ (ì•½ 40~50%)    | âœ… ì–‘í˜¸          |
| **`ğŸª¶ UI ë””ìì¸`** | Wide ë ˆì´ì•„ì›ƒ, Expander, Metric í™œìš© | âœ… ê°œì„  ì™„ë£Œ       |
| **`âš™ï¸ ì½”ë“œ êµ¬ì¡°`**  | `backend ëª¨ë“ˆ`ê³¼ `app.py` ë¶„ë¦¬ ëª…í™•       | âœ… ìœ ì§€ë³´ìˆ˜ ìš©ì´     |
| **`ğŸ”„ ì„¸ì…˜ ìƒíƒœ`**  | `retriever` / `uploaded_files` ê´€ë¦¬  | âœ… ì •ìƒ ìœ ì§€       |
| **`ğŸ’¾ ë°ì´í„° ê´€ë¦¬`** | `ë¡œì»¬ ì €ì¥` (ì„ì‹œ) / *Cloud ì—°ê²° ì˜ˆì •*       | *âš™ï¸ í–¥í›„ ì—…ë°ì´íŠ¸ ì˜ˆì •* |

<br>

## ğŸ¯ 5. Summary

| í•­ëª©                 | ì„¤ëª…                                              |
|--------------------|-------------------------------------------------|
| **`ğŸ“‚ íŒŒì¼ ê²½ë¡œ`**     | `/flownote-mvp/app.py`                          |
| **`ğŸ§  ê¸°ëŠ¥ ìš”ì•½`**     | `Streamlit ê¸°ë°˜ UI` ì™„ì„±, `ì—…ë¡œë“œ-ì²­í‚¹-ì„ë² ë”©-ê²€ìƒ‰` ì „ì²´ íŒŒì´í”„ë¼ì¸ êµ¬í˜„   |
| **`ğŸ§ª í…ŒìŠ¤íŠ¸ íŒŒì¼`**    | `test_chunking_embedding.py`, `test_faiss.py`       |
| **`ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼`**    | ì²­í‚¹ 4ê°œ ì²­í¬ / ì„ë² ë”© 367í† í° / FAISS ìœ ì‚¬ë„ 40.65%         |
| **`ğŸ’° í† í° ë¹„ìš©`**     | $0.000007                                       |
| **`ğŸ§© ì£¼ìš” íŒ¨í‚¤ì§€`**    | `streamlit`, `faiss-cpu`, `langchain`, `openai`, `dotenv` |
| **`ğŸ‰ MVP ì™„ì„± ì—¬ë¶€`** | **`âœ… ì „ì²´ íŒŒì´í”„ë¼ì¸ ì™„ì„±`** / **`ì •ìƒ ì‘ë™`** í™•ì¸                        |

<br>

## ğŸª„ 6. ì‹¤í–‰ ê°€ì´ë“œ

```bash
    # ê°€ìƒí™˜ê²½ í™œì„±í™”
    pyenv activate myenv

    # Streamlit ì‹¤í–‰
    streamlit run app.py

    # ë¸Œë¼ìš°ì € ìë™ ì‹¤í–‰
    # http://localhost:8501

```

<br>

## ğŸ“Œ 7. Review

### 1) ë¹„ê³ 

- í˜„ì¬ MVPëŠ” ë¡œì»¬ ê¸°ë°˜ ë™ì‘ (íŒŒì¼, ì¸ë±ìŠ¤, ì„ì‹œ ì €ì¥)

- ì°¨í›„ ë²„ì „(v1.1)ì—ì„œ í´ë¼ìš°ë“œ ì—°ë™ ë° ì‚¬ìš©ì ê³„ì • ê¸°ë°˜ ê²€ìƒ‰ ê¸°ë¡ ê¸°ëŠ¥ ì¶”ê°€ ì˜ˆì •

<br>

### 2) ğŸ“„ ìš”ì•½

- ğŸ¨ Streamlit UI ì™„ì „ ì—…ë°ì´íŠ¸
- ğŸ§ª í…ŒìŠ¤íŠ¸: ì²­í‚¹Â·ì„ë² ë”©Â·FAISS í†µí•© ì„±ê³µ
- ğŸ“¦ íŒ¨í‚¤ì§€ ì¢…ì†ì„± ì—…ë°ì´íŠ¸
- ğŸŠ MVP ê¸°ëŠ¥ ì™„ì„± ë° ì „ì²´ íŒŒì´í”„ë¼ì¸ ê²€ì¦ ì™„ë£Œ
