# v7.0 Phase 1: ì„¤ì • ë° êµ¬í˜„ ê°€ì´ë“œ

## ğŸ›  ì‚¬ì „ ì¤€ë¹„

### 1. ì˜ì¡´ì„± ì„¤ì¹˜
LangGraphì™€ ìµœì‹  LangChain íŒ¨í‚¤ì§€ê°€ í•„ìš”í•©ë‹ˆë‹¤.

```bash
# langgraph í•µì‹¬ ë¼ì´ë¸ŒëŸ¬ë¦¬
pip install langgraph langchain-openai langchain-core

# (ì„ íƒì‚¬í•­) ì‹œê°í™” ë° ë””ë²„ê¹… ë„êµ¬
pip install langsmith
```

### 2. í™˜ê²½ ë³€ìˆ˜ (.env)
LangSmith(ë””ë²„ê¹… ë„êµ¬) ì‚¬ìš© ì‹œ í‚¤ ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤ (ì„ íƒ ì‚¬í•­).

```env
# LangSmith ì„¤ì • (ì„ íƒì‚¬í•­ì´ì§€ë§Œ ì—ì´ì „íŠ¸ ê°œë°œ ì‹œ ê¶Œì¥)
LANGCHAIN_TRACING_V2=true
LANGCHAIN_API_KEY=lsv2_...
```

---

## ğŸ“‚ íŒŒì¼ êµ¬ì¡° ë³€ê²½

v7.0ì„ ìœ„í•´ `backend` ë””ë ‰í† ë¦¬ êµ¬ì¡°ë¥¼ í™•ì¥í•©ë‹ˆë‹¤.

```
backend/
â”œâ”€â”€ agent/                  # [ì‹ ê·œ] AI ì—ì´ì „íŠ¸ í•µì‹¬ ë¡œì§
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ graph.py            # StateGraph ì •ì˜
â”‚   â”œâ”€â”€ nodes.py            # ê°œë³„ ë…¸ë“œ í•¨ìˆ˜ (Analyze, Classify...)
â”‚   â”œâ”€â”€ state.py            # TypedDict State ìŠ¤í‚¤ë§ˆ
â”‚   â””â”€â”€ prompts.py          # ì—ì´ì „íŠ¸ ì „ìš© ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸
â”‚
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ classifier_service.py # [íê¸° ì˜ˆì • â†’ ë˜í¼] ì—ì´ì „íŠ¸ í˜¸ì¶œ
â”‚   â””â”€â”€ ...
```

---

## ğŸš€ êµ¬í˜„ ë‹¨ê³„ (1ì¼ì°¨)

### Step 1: State ì •ì˜ (`agent/state.py`)
ì—ì´ì „íŠ¸ê°€ ê³µìœ í•  ë°ì´í„° êµ¬ì¡°ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

```python
from typing import TypedDict, List, Optional

class AgentState(TypedDict):
    filename: str
    content: str
    classification: Optional[dict]
    confidence: float
    retry_count: int
```

### Step 2: ë…¸ë“œ êµ¬í˜„ (`agent/nodes.py`)
ê° ë‹¨ê³„ë³„ ë¡œì§ì„ í•¨ìˆ˜ë¡œ êµ¬í˜„í•©ë‹ˆë‹¤.

```python
def classify_node(state: AgentState):
    # LLM í˜¸ì¶œ
    result = llm.invoke(...)
    return {"classification": result, "confidence": result.score}

def validate_node(state: AgentState):
    # ê²€ì¦ ë¡œì§
    pass
```

### Step 3: ê·¸ë˜í”„ êµ¬ì¶• (`agent/graph.py`)
ì •ì˜ëœ ë…¸ë“œë“¤ì„ ì—°ê²°í•©ë‹ˆë‹¤.

```python
from langgraph.graph import StateGraph

def create_workflow():
    workflow = StateGraph(AgentState)
    # ... (ë…¸ë“œ ë° ì—£ì§€ ì¶”ê°€)
    return workflow.compile()
```

### Step 4: API í†µí•© (`api/endpoints/classify.py`)
ê¸°ì¡´ ì—”ë“œí¬ì¸íŠ¸ì—ì„œ `classifier_service` ëŒ€ì‹  `agent`ë¥¼ í˜¸ì¶œí•˜ë„ë¡ ìˆ˜ì •í•©ë‹ˆë‹¤.

```python
# ì´ì „
result = await classifier_service.classify(text)

# ì´í›„
app = create_workflow()
result = await app.ainvoke({"content": text, "filename": filename})
final_category = result["classification"]
```

---

## âš ï¸ ì£¼ìš” ê³ ë ¤ì‚¬í•­

1.  **ì§€ì—°ì‹œê°„**: ì—ì´ì „íŠ¸ ë£¨í”„ê°€ ëŒë©´ ì‘ë‹µ ì‹œê°„ì´ ê¸¸ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    - â†’ **ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ** ë„ì…ì„ ê³ ë ¤í•˜ê±°ë‚˜, ì‚¬ìš©ìì—ê²Œ "ë¶„ì„ ì¤‘..." ìƒíƒœë¥¼ ëª…í™•íˆ ë³´ì—¬ì£¼ëŠ” UI/UX ê°œì„ ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
2.  **ë¹„ìš©**: ë‹¤ë‹¨ê³„ LLM í˜¸ì¶œë¡œ í† í° ì‚¬ìš©ëŸ‰ì´ ì¦ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    - â†’ `InputAnalysis` ë‹¨ê³„ì—ì„œëŠ” **gpt-4o-mini** ê°™ì€ ê²½ëŸ‰ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì„¸ìš”.
    - â†’ ìµœì¢… `Classification` ë‹¨ê³„ì—ì„œë§Œ **gpt-4o**ë¥¼ ì‚¬ìš©í•˜ëŠ” í•˜ì´ë¸Œë¦¬ë“œ ì „ëµì„ ì¶”ì²œí•©ë‹ˆë‹¤.
3.  **í´ë°±**: ì—ì´ì „íŠ¸ê°€ ì‹¤íŒ¨í•˜ê±°ë‚˜ ë£¨í”„ê°€ ë„ˆë¬´ ê¸¸ì–´ì§ˆ ê²½ìš°(ìµœëŒ€ ì¬ì‹œë„ ì´ˆê³¼), ê¸°ë³¸ ê·œì¹™ ê¸°ë°˜ ë¶„ë¥˜(Rule-based)ë¡œ ë„˜ì–´ê°€ë„ë¡ ì•ˆì „ì¥ì¹˜ë¥¼ ë§ˆë ¨í•˜ì„¸ìš”.
