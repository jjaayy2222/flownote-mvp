(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python test_api_all_endpoints.py
ğŸš€ Testing ALL Backend API Files

======================================================================
ğŸ§ª Testing: backend/api/routes.py
âœ… routes.py loaded successfully

ğŸ§ª Testing: backend/api/models.py
âœ… models.py exists (import check: cannot import name 'DashboardModel' from 'backend.api.models' (/Users/jay/ICT-projects/flownote-mvp/backend/api/models/__init__.py))

ğŸ§ª Testing: backend/api/endpoints/dashboard.py
âœ… dashboard.py endpoint loaded

ğŸ§ª Testing: GET /dashboard/status
âœ… MetadataAggregator loaded successfully
âœ… Status: ready

ğŸ§ª Testing: GET /dashboard/metrics
âœ… Metrics loaded: ['file_statistics', 'para_breakdown', 'keyword_categories']

ğŸ§ª Testing: GET /dashboard/keywords
âœ… Keywords count: 5

ğŸ§ª Testing: backend/api/endpoints/classify.py
âœ… classify.py endpoint loaded

ğŸ§ª Testing: backend/api/endpoints/search.py
âœ… search.py endpoint loaded

ğŸ§ª Testing: backend/api/endpoints/metadata.py
âœ… metadata.py endpoint loaded

ğŸ§ª Testing: Full Integration
   âœ… backend/api/routes.py
   âœ… backend/api/models.py
   âœ… backend/api/endpoints/dashboard.py
   âœ… backend/api/endpoints/classify.py
   âœ… backend/api/endpoints/search.py
   âœ… backend/api/endpoints/metadata.py
âœ… All 6 files loaded and integrated!

======================================================================
âœ… All Backend API Files Successfully Tested!
(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_api_all_endpoints.py -v -s
============================================== test session starts ==============================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collected 10 items                                                                                              

test_api_all_endpoints.py::TestAllBackendAPIFiles::test_routes_py_import ğŸ§ª Testing: backend/api/routes.py
âœ… routes.py loaded successfully
PASSED
test_api_all_endpoints.py::TestAllBackendAPIFiles::test_models_py_import ğŸ§ª Testing: backend/api/models.py
âœ… models.py exists (import check: cannot import name 'DashboardModel' from 'backend.api.models' (/Users/jay/ICT-projects/flownote-mvp/backend/api/models/__init__.py))
PASSED
test_api_all_endpoints.py::TestAllBackendAPIFiles::test_dashboard_endpoint_import ğŸ§ª Testing: backend/api/endpoints/dashboard.py
âœ… dashboard.py endpoint loaded
PASSED
test_api_all_endpoints.py::TestAllBackendAPIFiles::test_dashboard_status_endpoint ğŸ§ª Testing: GET /dashboard/status
âœ… MetadataAggregator loaded successfully
âœ… Status: ready
PASSED
test_api_all_endpoints.py::TestAllBackendAPIFiles::test_dashboard_metrics_endpoint ğŸ§ª Testing: GET /dashboard/metrics
âœ… Metrics loaded: ['file_statistics', 'para_breakdown', 'keyword_categories']
PASSED
test_api_all_endpoints.py::TestAllBackendAPIFiles::test_dashboard_keywords_endpoint ğŸ§ª Testing: GET /dashboard/keywords
âœ… Keywords count: 5
PASSED
test_api_all_endpoints.py::TestAllBackendAPIFiles::test_classify_endpoint_import ğŸ§ª Testing: backend/api/endpoints/classify.py
âœ… classify.py endpoint loaded
PASSED
test_api_all_endpoints.py::TestAllBackendAPIFiles::test_search_endpoint_import ğŸ§ª Testing: backend/api/endpoints/search.py
âœ… search.py endpoint loaded
PASSED
test_api_all_endpoints.py::TestAllBackendAPIFiles::test_metadata_endpoint_import ğŸ§ª Testing: backend/api/endpoints/metadata.py
âœ… metadata.py endpoint loaded
PASSED
test_api_all_endpoints.py::TestAllBackendAPIFiles::test_all_files_integration ğŸ§ª Testing: Full Integration
   âœ… backend/api/routes.py
   âœ… backend/api/models.py
   âœ… backend/api/endpoints/dashboard.py
   âœ… backend/api/endpoints/classify.py
   âœ… backend/api/endpoints/search.py
   âœ… backend/api/endpoints/metadata.py
âœ… All 6 files loaded and integrated!
PASSED

=============================================== warnings summary ================================================
../backend/api/models/conflict_models.py:54
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:54: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ConflictDetail(BaseModel):

../backend/api/models/conflict_models.py:80
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:80: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ConflictRecord(BaseModel):

../backend/api/models/conflict_models.py:130
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:130: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ResolutionStrategy(BaseModel):

../backend/api/models/conflict_models.py:161
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:161: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ConflictResolution(BaseModel):

../backend/api/models/conflict_models.py:200
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:200: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ConflictReport(BaseModel):

../backend/api/models/conflict_models.py:267
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:267: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class DetectConflictRequest(BaseModel):

../backend/api/models/conflict_models.py:290
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:290: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ResolveConflictRequest(BaseModel):

../backend/api/models/conflict_models.py:318
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:318: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ConflictDetectResponse(BaseModel):

../backend/api/models/conflict_models.py:340
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:340: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ConflictResolveResponse(BaseModel):

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================================== 10 passed, 9 warnings in 0.24s =========================================

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_dashboard.py -v -s
============================================ test session starts =============================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collected 0 items                                                                                            

=========================================== no tests ran in 0.00s ============================================
ERROR: file or directory not found: test_dashboard.py


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_api_e2e_complete.py -v -s
============================================ test session starts =============================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collecting ... âœ… ê°œì„ ëœ E2E í…ŒìŠ¤íŠ¸ íŒŒì¼ ìƒì„± ì™„ë£Œ!
ğŸ“ íŒŒì¼ ìœ„ì¹˜: /tmp/test_api_e2e_improved.py
ğŸ“Š ì½”ë“œ ë¼ì¸: 9 ì¤„

======================================================================
ì£¼ìš” ê¸°ëŠ¥:
======================================================================

âœ… ê²°ê³¼ ì €ì¥ ê¸°ëŠ¥
    â””â”€ tests/outputs/ ë””ë ‰í† ë¦¬ì— ìë™ ì €ì¥
    â””â”€ ê° ë‹¨ê³„ë³„ ê²°ê³¼: step_01_upload_*.json
    â””â”€ í†µí•© ê²°ê³¼: test_results_complete_*.json

âœ… íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ íŒŒì¼ëª…
    â””â”€ YYYYMMDD_HHMMSS í˜•ì‹
    â””â”€ ì—¬ëŸ¬ ë²ˆ ì‹¤í–‰ ì‹œì—ë„ íŒŒì¼ ë®ì–´ì“°ê¸° ë°©ì§€

âœ… ê²°ê³¼ ìš”ì•½ ì¶œë ¥
    â””â”€ í…ŒìŠ¤íŠ¸ ì™„ë£Œ ì‹œ ìš”ì•½ ì •ë³´ ì¶œë ¥
    â””â”€ ì €ì¥ëœ íŒŒì¼ ê²½ë¡œ í‘œì‹œ

âœ… Dashboardìš© ë°ì´í„° êµ¬ì¡°
    â””â”€ JSON í˜•ì‹ìœ¼ë¡œ UI ìƒì„± ê°€ëŠ¥
    â””â”€ íŒŒì¼ ëª©ë¡, ë¶„ë¥˜, ì¶©ëŒ, í†µê³„ í¬í•¨

collected 6 items                                                                                            

test_api_e2e_complete.py::TestEndToEndWorkflow::test_01_file_upload \nğŸ“¤ Step 1: íŒŒì¼ ì—…ë¡œë“œ í…ŒìŠ¤íŠ¸...
âœ… ì—…ë¡œë“œ ì™„ë£Œ: project_flownote.md
âœ… ì—…ë¡œë“œ ì™„ë£Œ: area_development.md
âœ… ì—…ë¡œë“œ ì™„ë£Œ: resource_docs.md
âœ… ì—…ë¡œë“œ ì™„ë£Œ: archive_old.md
âœ… ì €ì¥ë¨: /Users/jay/ICT-projects/flownote-mvp/tests/outputs/step_01_upload_20251113_202717.json
PASSED
test_api_e2e_complete.py::TestEndToEndWorkflow::test_02_file_classification \nğŸ“Š Step 2: íŒŒì¼ ë¶„ë¥˜ í…ŒìŠ¤íŠ¸...
âœ… ë¶„ë¥˜ ì™„ë£Œ: project_flownote.md â†’ Projects (ì‹ ë¢°ë„: 0.95)
âœ… ë¶„ë¥˜ ì™„ë£Œ: area_development.md â†’ Areas (ì‹ ë¢°ë„: 0.92)
âœ… ë¶„ë¥˜ ì™„ë£Œ: resource_docs.md â†’ Resources (ì‹ ë¢°ë„: 0.9)
âœ… ë¶„ë¥˜ ì™„ë£Œ: archive_old.md â†’ Archives (ì‹ ë¢°ë„: 0.88)
âœ… ì €ì¥ë¨: /Users/jay/ICT-projects/flownote-mvp/tests/outputs/step_02_classification_20251113_202717.json
PASSED
test_api_e2e_complete.py::TestEndToEndWorkflow::test_03_conflict_detection \nâš ï¸  Step 3: ì¶©ëŒ ê°ì§€ í…ŒìŠ¤íŠ¸...
âœ… ì¶©ëŒ ê°ì§€ ì™„ë£Œ: 0ê°œ ì¶©ëŒ ë°œê²¬
âœ… ì €ì¥ë¨: /Users/jay/ICT-projects/flownote-mvp/tests/outputs/step_03_conflict_detection_20251113_202717.json
PASSED
test_api_e2e_complete.py::TestEndToEndWorkflow::test_04_conflict_resolution \nğŸ”§ Step 4: ì¶©ëŒ í•´ê²° í…ŒìŠ¤íŠ¸...
âœ… ì¶©ëŒ í•´ê²° ì™„ë£Œ: ëª¨ë“  ì¶©ëŒì´ í•´ê²°ë¨
âœ… ì €ì¥ë¨: /Users/jay/ICT-projects/flownote-mvp/tests/outputs/step_04_conflict_resolution_20251113_202717.json
PASSED
test_api_e2e_complete.py::TestEndToEndWorkflow::test_05_dashboard_integration \nğŸ“‹ Step 5: Dashboard ì¡°íšŒ í…ŒìŠ¤íŠ¸...
âœ… Dashboard ì¡°íšŒ ì™„ë£Œ
   - ì´ íŒŒì¼: 4
   - ë¶„ë¥˜ëœ íŒŒì¼: 4
   - í‰ê·  ì‹ ë¢°ë„: 0.91
âœ… ì €ì¥ë¨: /Users/jay/ICT-projects/flownote-mvp/tests/outputs/step_05_dashboard_20251113_202717.json
PASSED
test_api_e2e_complete.py::TestEndToEndWorkflow::test_00_complete_e2e_workflow \n======================================================================
ğŸš€ E2E ì›Œí¬í”Œë¡œìš° í†µí•© í…ŒìŠ¤íŠ¸ ì‹œì‘
======================================================================
\nğŸ“¤ Step 1: íŒŒì¼ ì—…ë¡œë“œ í…ŒìŠ¤íŠ¸...
âœ… ì—…ë¡œë“œ ì™„ë£Œ: project_flownote.md
âœ… ì—…ë¡œë“œ ì™„ë£Œ: area_development.md
âœ… ì—…ë¡œë“œ ì™„ë£Œ: resource_docs.md
âœ… ì—…ë¡œë“œ ì™„ë£Œ: archive_old.md
âœ… ì €ì¥ë¨: /Users/jay/ICT-projects/flownote-mvp/tests/outputs/step_01_upload_20251113_202717.json
\nğŸ“Š Step 2: íŒŒì¼ ë¶„ë¥˜ í…ŒìŠ¤íŠ¸...
âœ… ë¶„ë¥˜ ì™„ë£Œ: project_flownote.md â†’ Projects (ì‹ ë¢°ë„: 0.95)
âœ… ë¶„ë¥˜ ì™„ë£Œ: area_development.md â†’ Areas (ì‹ ë¢°ë„: 0.92)
âœ… ë¶„ë¥˜ ì™„ë£Œ: resource_docs.md â†’ Resources (ì‹ ë¢°ë„: 0.9)
âœ… ë¶„ë¥˜ ì™„ë£Œ: archive_old.md â†’ Archives (ì‹ ë¢°ë„: 0.88)
âœ… ì €ì¥ë¨: /Users/jay/ICT-projects/flownote-mvp/tests/outputs/step_02_classification_20251113_202717.json
\nâš ï¸  Step 3: ì¶©ëŒ ê°ì§€ í…ŒìŠ¤íŠ¸...
âœ… ì¶©ëŒ ê°ì§€ ì™„ë£Œ: 0ê°œ ì¶©ëŒ ë°œê²¬
âœ… ì €ì¥ë¨: /Users/jay/ICT-projects/flownote-mvp/tests/outputs/step_03_conflict_detection_20251113_202717.json
\nğŸ”§ Step 4: ì¶©ëŒ í•´ê²° í…ŒìŠ¤íŠ¸...
âœ… ì¶©ëŒ í•´ê²° ì™„ë£Œ: ëª¨ë“  ì¶©ëŒì´ í•´ê²°ë¨
âœ… ì €ì¥ë¨: /Users/jay/ICT-projects/flownote-mvp/tests/outputs/step_04_conflict_resolution_20251113_202717.json
\nğŸ“‹ Step 5: Dashboard ì¡°íšŒ í…ŒìŠ¤íŠ¸...
âœ… Dashboard ì¡°íšŒ ì™„ë£Œ
   - ì´ íŒŒì¼: 4
   - ë¶„ë¥˜ëœ íŒŒì¼: 4
   - í‰ê·  ì‹ ë¢°ë„: 0.91
âœ… ì €ì¥ë¨: /Users/jay/ICT-projects/flownote-mvp/tests/outputs/step_05_dashboard_20251113_202717.json
\nğŸ“Š ìµœì¢… ê²°ê³¼ ì €ì¥ë¨: /Users/jay/ICT-projects/flownote-mvp/tests/outputs/test_results_complete_20251113_202717.json
\n======================================================================
ğŸ“‹ í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½
======================================================================
ì‹¤í–‰ ì‹œê°„: 20251113_202717
ê²°ê³¼ ì €ì¥ ìœ„ì¹˜: /Users/jay/ICT-projects/flownote-mvp/tests/outputs
\ní…ŒìŠ¤íŠ¸ ë‹¨ê³„ë³„ ê²°ê³¼:
  step_01_upload: âœ… ì„±ê³µ
  step_02_classification: âœ… ì„±ê³µ
  step_03_conflict_detection: âœ… ì„±ê³µ
  step_04_conflict_resolution: âœ… ì„±ê³µ
  step_05_dashboard: âœ… ì„±ê³µ
======================================================================
\nâœ… E2E ì›Œí¬í”Œë¡œìš° ì™„ë£Œ - ëª¨ë“  í…ŒìŠ¤íŠ¸ ì„±ê³µ!
======================================================================
PASSED

============================================= 6 passed in 0.21s ==============================================

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_api_e2e_complete2.py -v -s
============================================ test session starts =============================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collected 1 item                                                                                             

test_api_e2e_complete2.py::test_complete_workflow FAILED

================================================== FAILURES ==================================================
___________________________________________ test_complete_workflow ___________________________________________

    def test_complete_workflow():
        # 1. ì˜¨ë³´ë”©
        onboarding_response = requests.post(
            "http://localhost:8000/api/onboarding/initialize",
            json={
                "name": "Jay",
                "occupation": "AI Engineer",
                "areas": ["Python", "AI/ML", "Backend"],
                "projects": ["FlowNote"]
            }
        )
>       user_id = onboarding_response.json()["user_id"]
E       KeyError: 'user_id'

test_api_e2e_complete2.py:40: KeyError
========================================== short test summary info ===========================================
FAILED test_api_e2e_complete2.py::test_complete_workflow - KeyError: 'user_id'
============================================= 1 failed in 0.28s ==============================================

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_api_e2e.py -v -s
============================================ test session starts =============================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collected 4 items                                                                                            

test_api_e2e.py::test_api_health PASSED
test_api_e2e.py::test_classification_flow PASSED
test_api_e2e.py::test_metadata_public PASSED
test_api_e2e.py::test_dashboard_integration PASSED

============================================= 4 passed in 0.01s ==============================================

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_api_e2e.py -v -s
============================================ test session starts =============================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collected 4 items                                                                                            

test_api_e2e.py::test_api_health PASSED
test_api_e2e.py::test_classification_flow PASSED
test_api_e2e.py::test_metadata_public PASSED
test_api_e2e.py::test_dashboard_integration PASSED

============================================= 4 passed in 0.01s ==============================================
(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_chunking_embedding.py -v -s
============================================ test session starts =============================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collected 0 items / 1 error                                                                                  

=================================================== ERRORS ===================================================
________________________________ ERROR collecting test_chunking_embedding.py _________________________________
ImportError while importing test module '/Users/jay/ICT-projects/flownote-mvp/tests/test_chunking_embedding.py'.
Hint: make sure your test modules/packages have valid Python names.
Traceback:
../../../.pyenv/versions/3.11.10/lib/python3.11/importlib/__init__.py:126: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
test_chunking_embedding.py:16: in <module>
    from backend.chunking import chunk_text, chunk_with_metadata
E   ImportError: cannot import name 'chunk_text' from 'backend.chunking' (/Users/jay/ICT-projects/flownote-mvp/backend/chunking.py)
========================================== short test summary info ===========================================
ERROR test_chunking_embedding.py
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! Interrupted: 1 error during collection !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
============================================== 1 error in 0.11s ==============================================

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python test_chunking_embedding.py
Traceback (most recent call last):
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_chunking_embedding.py", line 16, in <module>
    from backend.chunking import chunk_text, chunk_with_metadata
ImportError: cannot import name 'chunk_text' from 'backend.chunking' (/Users/jay/ICT-projects/flownote-mvp/backend/chunking.py)
(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python -m test_chunking_embedding
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_chunking_embedding.py", line 16, in <module>
    from backend.chunking import chunk_text, chunk_with_metadata
ImportError: cannot import name 'chunk_text' from 'backend.chunking' (/Users/jay/ICT-projects/flownote-mvp/backend/chunking.py)


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_classification_flow.py -v -s
============================================ test session starts =============================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collected 5 items                                                                                            

test_classification_flow.py::test_1_keyword_classifier 
============================================================
í…ŒìŠ¤íŠ¸ 1: KeywordClassifier ë‹¨ë… í…ŒìŠ¤íŠ¸
============================================================

ğŸ“ í…ìŠ¤íŠ¸: í”„ë¡œì íŠ¸ ì™„ì„±í•˜ê¸°
  âœ… Tags: ['ê¸°íƒ€']
  âœ… Confidence: 0.0
  âœ… Is Fallback: False

ğŸ“ í…ìŠ¤íŠ¸: íšŒì˜ ì¤€ë¹„
  âœ… Tags: ['ê¸°íƒ€']
  âœ… Confidence: 0.0
  âœ… Is Fallback: False

ğŸ“ í…ìŠ¤íŠ¸: ê±´ê°• ê´€ë¦¬ ê³„íš
  âœ… Tags: ['ê¸°íƒ€']
  âœ… Confidence: 0.0
  âœ… Is Fallback: False

âœ… í…ŒìŠ¤íŠ¸ 1 í†µê³¼!
PASSED
test_classification_flow.py::test_2_conflict_service 
============================================================
í…ŒìŠ¤íŠ¸ 2: ConflictService í…ŒìŠ¤íŠ¸
============================================================
âœ… ModelConfig loaded from backend.config

ğŸ“Š ë¶„ë¥˜ ê²°ê³¼:
  - PARA: None
  - Keywords: []
  - Final: None
  - Snapshot: error_20251113_203108
FAILED
test_classification_flow.py::test_3_db_storage 
============================================================
í…ŒìŠ¤íŠ¸ 3: DB ì €ì¥ í…ŒìŠ¤íŠ¸
============================================================
âœ… conflict_flag ì»¬ëŸ¼ ì¶”ê°€ ì™„ë£Œ
âœ… resolution_method ì»¬ëŸ¼ ì¶”ê°€ ì™„ë£Œ
âœ… snapshot_id ì»¬ëŸ¼ ì¶”ê°€ ì™„ë£Œ
âœ… ë¶„ë¥˜ ê²°ê³¼ ì €ì¥ ì™„ë£Œ: file_id=1, snapshot_id=test_snapshot_123

âœ… DB ì €ì¥ ì„±ê³µ: file_id=1
âœ… ì´ 1ê°œ ë¶„ë¥˜ ê²°ê³¼ ì €ì¥ë¨

ë§ˆì§€ë§‰ ì €ì¥ ê²°ê³¼:
  - Filename: test_20251113_203108.txt
  - Category: Projects
  - Keywords: ì—…ë¬´,í”„ë¡œì íŠ¸
  - Snapshot: test_snapshot_123

âœ… í…ŒìŠ¤íŠ¸ 3 í†µê³¼!
PASSED
test_classification_flow.py::test_4_classification_log 
============================================================
í…ŒìŠ¤íŠ¸ 4: classification_log ê¸°ë¡ í…ŒìŠ¤íŠ¸
============================================================
âœ… [CSV LOG] classification_log.csv ê¸°ë¡ ì™„ë£Œ: test_file.txt

âœ… ë¡œê·¸ ê¸°ë¡ ê²°ê³¼: {'status': 'success'}
âœ… ë¡œê·¸ íŒŒì¼ ì´ 2ì¤„

ë§ˆì§€ë§‰ ì¤„:
  2025-11-13T20:31:08.755071,test_user,test_file.txt,Projects,,0.9,pending

âœ… í…ŒìŠ¤íŠ¸ 4 í†µê³¼!
PASSED
test_classification_flow.py::test_5_api_endpoint 
============================================================
í…ŒìŠ¤íŠ¸ 5: API ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸ (curl ëª…ë ¹ì–´)
============================================================

ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤!
ì‹¤í–‰ ëª…ë ¹ì–´:
  uvicorn backend.main:app --reload --port 8000

í…ŒìŠ¤íŠ¸ curl ëª…ë ¹ì–´:

curl -X POST "http://127.0.0.1:8000/api/classify/keywords" \
  -H "Content-Type: application/json" \
  -d '{"text": "ì˜ì–´ ê³µë¶€í•˜ê¸°",
    "user_id": "test_user_3",
    "file_id": "test_file_003"
  }' | jq '.'
    

í™•ì¸ ì‚¬í•­:
  1. keyword_tagsê°€ ë¹„ì–´ìˆì§€ ì•Šì€ê°€?
  2. confidenceê°€ 0ì´ ì•„ë‹Œê°€?
  3. categoryê°€ ì œëŒ€ë¡œ ì„¤ì •ë˜ì—ˆë‚˜?

âœ… í…ŒìŠ¤íŠ¸ 5 ì¤€ë¹„ ì™„ë£Œ! (ìˆ˜ë™ ì‹¤í–‰ í•„ìš”)
PASSED

================================================== FAILURES ==================================================
__________________________________________ test_2_conflict_service ___________________________________________

    def test_2_conflict_service():
        """í…ŒìŠ¤íŠ¸ 2: ConflictService í…ŒìŠ¤íŠ¸"""
        print("\n" + "="*60)
        print("í…ŒìŠ¤íŠ¸ 2: ConflictService í…ŒìŠ¤íŠ¸")
        print("="*60)
    
        from backend.services.conflict_service import ConflictService
    
        service = ConflictService()
    
        # async ì œê±°
        result = service.classify_text("í”„ë¡œì íŠ¸ ì™„ì„±í•˜ê¸°")
    
        print(f"\nğŸ“Š ë¶„ë¥˜ ê²°ê³¼:")
        print(f"  - PARA: {result.get('para_result', {}).get('category')}")
        print(f"  - Keywords: {result.get('keyword_result', {}).get('tags', [])}")
        print(f"  - Final: {result.get('conflict_result', {}).get('final_category')}")
        print(f"  - Snapshot: {result.get('snapshot_id')}")
    
        # keyword_tags í™•ì¸
        keyword_tags = result.get('keyword_result', {}).get('tags', [])
>       assert len(keyword_tags) > 0, "âŒ keyword_tagsê°€ ë¹„ì–´ìˆìŒ!"
E       AssertionError: âŒ keyword_tagsê°€ ë¹„ì–´ìˆìŒ!
E       assert 0 > 0
E        +  where 0 = len([])

test_classification_flow.py:76: AssertionError
--------------------------------------------- Captured log call ----------------------------------------------
ERROR    backend.services.conflict_service:conflict_service.py:128 âŒ ë¶„ë¥˜ ì˜¤ë¥˜: 'coroutine' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/jay/ICT-projects/flownote-mvp/backend/services/conflict_service.py", line 84, in classify_text
    logger.info(f"  âœ… PARA: {para_result.get('category')}")
                              ^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'get'
============================================== warnings summary ==============================================
../backend/api/models/conflict_models.py:54
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:54: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ConflictDetail(BaseModel):

../backend/api/models/conflict_models.py:80
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:80: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ConflictRecord(BaseModel):

../backend/api/models/conflict_models.py:130
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:130: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ResolutionStrategy(BaseModel):

../backend/api/models/conflict_models.py:161
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:161: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ConflictResolution(BaseModel):

../backend/api/models/conflict_models.py:200
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:200: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ConflictReport(BaseModel):

../backend/api/models/conflict_models.py:267
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:267: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class DetectConflictRequest(BaseModel):

../backend/api/models/conflict_models.py:290
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:290: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ResolveConflictRequest(BaseModel):

../backend/api/models/conflict_models.py:318
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:318: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ConflictDetectResponse(BaseModel):

../backend/api/models/conflict_models.py:340
  /Users/jay/ICT-projects/flownote-mvp/backend/api/models/conflict_models.py:340: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ConflictResolveResponse(BaseModel):

test_classification_flow.py::test_2_conflict_service
  /Users/jay/.pyenv/versions/3.11.10/envs/myenv/lib/python3.11/site-packages/_pytest/stash.py:108: RuntimeWarning: coroutine 'run_para_agent' was never awaited
    del self._storage[key]
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
========================================== short test summary info ===========================================
FAILED test_classification_flow.py::test_2_conflict_service - AssertionError: âŒ keyword_tagsê°€ ë¹„ì–´ìˆìŒ!
================================= 1 failed, 4 passed, 10 warnings in 16.26s ==================================


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python -m test_classification_flow

============================================================
í…ŒìŠ¤íŠ¸ 1: KeywordClassifier ë‹¨ë… í…ŒìŠ¤íŠ¸
============================================================
INFO:backend.classifier.keyword_classifier:âœ… ModelConfig loaded from backend.config
INFO:backend.classifier.keyword_classifier:âœ… KeywordClassifier LLM ì´ˆê¸°í™” ì„±ê³µ
INFO:backend.classifier.keyword_classifier:[70b9e39e] âœ… Chain ìƒì„± ì„±ê³µ (í”„ë¡¬í”„íŠ¸ íŒŒì¼ ë¡œë“œ ì™„ë£Œ)
INFO:backend.classifier.keyword_classifier:âœ… KeywordClassifier initialized (ID: 70b9e39e, Time: 20:31:57)
INFO:backend.classifier.keyword_classifier:ğŸ” [70b9e39e] CLASSIFY ì‹œì‘: text_len=9, has_context=False
INFO:backend.classifier.keyword_classifier:[70b9e39e] ğŸ” Calling LLM (sync)...
INFO:httpx:HTTP Request: POST https://mlapi.run/40cc17ae-a89b-4f12-a7d6-13293180fc87/v1/chat/completions "HTTP/1.1 200 OK"
INFO:backend.classifier.keyword_classifier:[70b9e39e] âœ… ë¶„ë¥˜ ì™„ë£Œ (sync):
INFO:backend.classifier.keyword_classifier:[70b9e39e]   - Tags: ['ê¸°íƒ€']

ğŸ“ í…ìŠ¤íŠ¸: í”„ë¡œì íŠ¸ ì™„ì„±í•˜ê¸°
  âœ… Tags: ['ê¸°íƒ€']
  âœ… Confidence: 0.0
  âœ… Is Fallback: False
INFO:backend.classifier.keyword_classifier:âœ… KeywordClassifier LLM ì´ˆê¸°í™” ì„±ê³µ
INFO:backend.classifier.keyword_classifier:[987bfcf0] âœ… Chain ìƒì„± ì„±ê³µ (í”„ë¡¬í”„íŠ¸ íŒŒì¼ ë¡œë“œ ì™„ë£Œ)
INFO:backend.classifier.keyword_classifier:âœ… KeywordClassifier initialized (ID: 987bfcf0, Time: 20:32:02)
INFO:backend.classifier.keyword_classifier:ğŸ” [987bfcf0] CLASSIFY ì‹œì‘: text_len=5, has_context=False
INFO:backend.classifier.keyword_classifier:[987bfcf0] ğŸ” Calling LLM (sync)...
INFO:httpx:HTTP Request: POST https://mlapi.run/40cc17ae-a89b-4f12-a7d6-13293180fc87/v1/chat/completions "HTTP/1.1 200 OK"
INFO:backend.classifier.keyword_classifier:[987bfcf0] âœ… ë¶„ë¥˜ ì™„ë£Œ (sync):
INFO:backend.classifier.keyword_classifier:[987bfcf0]   - Tags: ['ê¸°íƒ€']

ğŸ“ í…ìŠ¤íŠ¸: íšŒì˜ ì¤€ë¹„
  âœ… Tags: ['ê¸°íƒ€']
  âœ… Confidence: 0.0
  âœ… Is Fallback: False
INFO:backend.classifier.keyword_classifier:âœ… KeywordClassifier LLM ì´ˆê¸°í™” ì„±ê³µ
INFO:backend.classifier.keyword_classifier:[43d21051] âœ… Chain ìƒì„± ì„±ê³µ (í”„ë¡¬í”„íŠ¸ íŒŒì¼ ë¡œë“œ ì™„ë£Œ)
INFO:backend.classifier.keyword_classifier:âœ… KeywordClassifier initialized (ID: 43d21051, Time: 20:32:07)
INFO:backend.classifier.keyword_classifier:ğŸ” [43d21051] CLASSIFY ì‹œì‘: text_len=8, has_context=False
INFO:backend.classifier.keyword_classifier:[43d21051] ğŸ” Calling LLM (sync)...
INFO:httpx:HTTP Request: POST https://mlapi.run/40cc17ae-a89b-4f12-a7d6-13293180fc87/v1/chat/completions "HTTP/1.1 200 OK"
INFO:backend.classifier.keyword_classifier:[43d21051] âœ… ë¶„ë¥˜ ì™„ë£Œ (sync):
INFO:backend.classifier.keyword_classifier:[43d21051]   - Tags: ['ê¸°íƒ€']

ğŸ“ í…ìŠ¤íŠ¸: ê±´ê°• ê´€ë¦¬ ê³„íš
  âœ… Tags: ['ê¸°íƒ€']
  âœ… Confidence: 0.0
  âœ… Is Fallback: False

âœ… í…ŒìŠ¤íŠ¸ 1 í†µê³¼!

============================================================
í…ŒìŠ¤íŠ¸ 2: ConflictService í…ŒìŠ¤íŠ¸
============================================================
âœ… ModelConfig loaded from backend.config
INFO:backend.services.conflict_service:âœ… ConflictService ì´ˆê¸°í™” ì™„ë£Œ
INFO:backend.services.conflict_service:âœ… ConflictService ì´ˆê¸°í™” ì™„ë£Œ
INFO:backend.services.conflict_service:ğŸ“ í†µí•© ë¶„ë¥˜ ì‹œì‘: í”„ë¡œì íŠ¸ ì™„ì„±í•˜ê¸°...
INFO:backend.services.conflict_service:1. PARA ë¶„ë¥˜ ì‹¤í–‰...
ERROR:backend.services.conflict_service:âŒ ë¶„ë¥˜ ì˜¤ë¥˜: 'coroutine' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/jay/ICT-projects/flownote-mvp/backend/services/conflict_service.py", line 84, in classify_text
    logger.info(f"  âœ… PARA: {para_result.get('category')}")
                              ^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'get'
/Users/jay/ICT-projects/flownote-mvp/tests/test_classification_flow.py:66: RuntimeWarning: coroutine 'run_para_agent' was never awaited
  result = service.classify_text("í”„ë¡œì íŠ¸ ì™„ì„±í•˜ê¸°")
RuntimeWarning: Enable tracemalloc to get the object allocation traceback

ğŸ“Š ë¶„ë¥˜ ê²°ê³¼:
  - PARA: None
  - Keywords: []
  - Final: None
  - Snapshot: error_20251113_203211

âŒ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: âŒ keyword_tagsê°€ ë¹„ì–´ìˆìŒ!
Traceback (most recent call last):
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_classification_flow.py", line 196, in <module>
    test_2_conflict_service()
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_classification_flow.py", line 76, in test_2_conflict_service
    assert len(keyword_tags) > 0, "âŒ keyword_tagsê°€ ë¹„ì–´ìˆìŒ!"
           ^^^^^^^^^^^^^^^^^^^^^
AssertionError: âŒ keyword_tagsê°€ ë¹„ì–´ìˆìŒ!


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_compatibility.py -v -s
============================================ test session starts =============================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collecting ... âœ… ModelConfig loaded from backend.config
collected 0 items                                                                                            

============================================== warnings summary ==============================================
test_compatibility.py:30
  /Users/jay/ICT-projects/flownote-mvp/tests/test_compatibility.py:30: PytestCollectionWarning: cannot collect test class 'TestIntegration' because it has a __init__ constructor (from: test_compatibility.py)
    class TestIntegration:

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
============================================= 1 warning in 0.62s =============================================


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python -m test_compatibility
âœ… ModelConfig loaded from backend.config

======================================================================
ğŸ¯ Integration Tests - ì „ì²´ ì‹œìŠ¤í…œ ê²€ì¦
======================================================================
INFO:backend.classifier.para_classifier:PARAClassifier initialized (LangChain: True)
INFO:backend.classifier.keyword_classifier:âœ… KeywordClassifier LLM ì´ˆê¸°í™” ì„±ê³µ
INFO:backend.classifier.keyword_classifier:[2a181658] âœ… Chain ìƒì„± ì„±ê³µ (í”„ë¡¬í”„íŠ¸ íŒŒì¼ ë¡œë“œ ì™„ë£Œ)
INFO:backend.classifier.keyword_classifier:âœ… KeywordClassifier initialized (ID: 2a181658, Time: 20:34:06)

ğŸ”· Step 1: PARA Classification Prompts
INFO:httpx:HTTP Request: POST https://mlapi.run/40cc17ae-a89b-4f12-a7d6-13293180fc87/v1/chat/completions "HTTP/1.1 200 OK"
INFO:backend.classifier.langchain_integration:ë¶„ë¥˜ ì™„ë£Œ: Projects (confidence: 95.00%, metadata: False)
   âœ… Category: Projects

ğŸ”· Step 2: PARAClassifier Module
INFO:httpx:HTTP Request: POST https://mlapi.run/40cc17ae-a89b-4f12-a7d6-13293180fc87/v1/chat/completions "HTTP/1.1 200 OK"
INFO:backend.classifier.langchain_integration:ë¶„ë¥˜ ì™„ë£Œ: Projects (confidence: 95.00%, metadata: False)
INFO:backend.classifier.para_classifier:Classified 'unknown' as 'Projects' (confidence: 95.00%)
   âœ… Para Classifier ì‘ë™: Projects

ğŸ”· Step 3: KeywordClassifier Module
   âœ… KeywordClassifier ê²€ì¦

ğŸ”· Step 4: ParallelProcessor (Metadata)
INFO:httpx:HTTP Request: POST https://mlapi.run/40cc17ae-a89b-4f12-a7d6-13293180fc87/v1/chat/completions "HTTP/1.1 200 OK"
INFO:backend.classifier.langchain_integration:ë¶„ë¥˜ ì™„ë£Œ: Projects (confidence: 95.00%, metadata: False)
INFO:httpx:HTTP Request: POST https://mlapi.run/40cc17ae-a89b-4f12-a7d6-13293180fc87/v1/chat/completions "HTTP/1.1 200 OK"
INFO:backend.classifier.langchain_integration:ë©”íƒ€ë°ì´í„° ë¶„ë¥˜ ì™„ë£Œ: Projects (confidence: 92.00%)
INFO:backend.services.parallel_processor:âœ… ë³‘ë ¬ ë¶„ë¥˜ ì™„ë£Œ (5.77ì´ˆ)
   âœ… ParallelProcessor ì‘ë™
      - Text Result: Projects
      - Meta Result: Projects

ğŸ”· Step 5: LangGraph Agent (StateGraph)
   âŒ Step 5 ì‹¤íŒ¨: 'coroutine' object has no attribute 'get'
/Users/jay/ICT-projects/flownote-mvp/tests/test_compatibility.py:205: RuntimeWarning: coroutine 'run_para_agent' was never awaited
  print(f"   âŒ Step 5 ì‹¤íŒ¨: {str(e)}")
RuntimeWarning: Enable tracemalloc to get the object allocation traceback

======================================================================

ğŸ”· FULL PIPELINE: Step 1 â†’ Step 5
======================================================================

Test 1: ì¶©ë¶„í•œ í…ìŠ¤íŠ¸
----------------------------------------------------------------------
   âŒ Full Pipeline ì‹¤íŒ¨: 'coroutine' object has no attribute 'get'
/Users/jay/ICT-projects/flownote-mvp/tests/test_compatibility.py:212: RuntimeWarning: coroutine 'run_para_agent' was never awaited
  print(f"   âŒ Full Pipeline ì‹¤íŒ¨: {str(e)}")
RuntimeWarning: Enable tracemalloc to get the object allocation traceback

======================================================================
ğŸ“Š Stepë³„ ê²€ì¦: 4/5 í†µê³¼
======================================================================

âš ï¸ 1ê°œ Stepì— ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_conflict_resolver.py -v -s
================================================ test session starts ================================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collected 3 items                                                                                                   

test_conflict_resolver.py::test_clear_winner_para PASSED: Test 1 - Clear winner (PARA)
PASSED
test_conflict_resolver.py::test_requires_user_review PASSED: Test 2 - Requires user review
PASSED
test_conflict_resolver.py::test_keyword_wins PASSED: Test 3 - Keyword wins
PASSED

================================================= 3 passed in 0.01s =================================================


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python -m test_conflict_resolver
Not ready: No module named 'backend'
Not ready: No module named 'backend'
Not ready: No module named 'backend'
(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python test_conflict_resolver.py
Not ready: No module named 'backend'
Not ready: No module named 'backend'
Not ready: No module named 'backend'


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_context_injector.py -v -s
================================================ test session starts ================================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collected 1 item                                                                                                    

test_context_injector.py::test_context_injector FAILED

===================================================== FAILURES ======================================================
_______________________________________________ test_context_injector _______________________________________________

    def test_context_injector():
    
        injector = ContextInjector()
    
        # 1. ì‚¬ìš©ì ë§¥ë½ ì£¼ì…
>       enriched = injector.enrich_with_context(        # <-- ì˜¤ë¥˜ ë°œìƒ
            text="Python ê°œë°œ",
            user_id="test_user"
        )
E       AttributeError: 'ContextInjector' object has no attribute 'enrich_with_context'

test_context_injector.py:36: AttributeError
============================================== short test summary info ==============================================
FAILED test_context_injector.py::test_context_injector - AttributeError: 'ContextInjector' object has no attribute 'enrich_with_context'
================================================= 1 failed in 1.14s =================================================

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python -m test_context_injector
-> tests/tests_phase_0/outputs/
-> tests/tests_phase_0/outputs/step_01_upload_20251113_202717.json
-> tests/tests_phase_0/outputs/step_02_classification_20251113_202717.json
-> tests/tests_phase_0/outputs/step_03_conflict_detection_20251113_202717.json
-> tests/tests_phase_0/outputs/step_04_conflict_resolution_20251113_202717.json
-> tests/tests_phase_0/outputs/step_05_dashboard_20251113_202717.json
-> tests/tests_phase_0/outputs/test_results_complete_20251113_202717.json


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_faiss.py -v -s
================================================== test session starts ===================================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collected 0 items / 1 error                                                                                              

========================================================= ERRORS =========================================================
_____________________________________________ ERROR collecting test_faiss.py _____________________________________________
ImportError while importing test module '/Users/jay/ICT-projects/flownote-mvp/tests/test_faiss.py'.
Hint: make sure your test modules/packages have valid Python names.
Traceback:
../../../.pyenv/versions/3.11.10/lib/python3.11/importlib/__init__.py:126: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
test_faiss.py:16: in <module>
    from backend.chunking import chunk_with_metadata
E   ImportError: cannot import name 'chunk_with_metadata' from 'backend.chunking' (/Users/jay/ICT-projects/flownote-mvp/backend/chunking.py)
================================================ short test summary info =================================================
ERROR test_faiss.py
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! Interrupted: 1 error during collection !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
==================================================== 1 error in 0.11s ====================================================

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python -m test_faiss  
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_faiss.py", line 16, in <module>
    from backend.chunking import chunk_with_metadata
ImportError: cannot import name 'chunk_with_metadata' from 'backend.chunking' (/Users/jay/ICT-projects/flownote-mvp/backend/chunking.py)

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python test_faiss.py
Traceback (most recent call last):
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_faiss.py", line 16, in <module>
    from backend.chunking import chunk_with_metadata
ImportError: cannot import name 'chunk_with_metadata' from 'backend.chunking' (/Users/jay/ICT-projects/flownote-mvp/backend/chunking.py)


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_gpt41_connection.py -v -s
==================================================== test session starts ====================================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collected 1 item                                                                                                            

test_gpt41_connection.py::test_gpt41_connection 
==================================================
ğŸ”§ GPT-4.1 API Connection Test
==================================================

ğŸ“‹ Configuration:
  API Key: âŒ Not set
  Base URL: âŒ Not set
  Model: âŒ Not set

âŒ Missing configuration in .env file

ğŸ’¡ Required in .env:
   GPT4.1_API_KEY=your_key_here
   GPT4.1_BASE_URL=your_base_url_here
   GPT4.1_MODEL=openai/gpt-4.1
PASSED

===================================================== warnings summary ======================================================
test_gpt41_connection.py::test_gpt41_connection
  /Users/jay/.pyenv/versions/3.11.10/envs/myenv/lib/python3.11/site-packages/_pytest/python.py:163: PytestReturnNotNoneWarning: Expected None, but test_gpt41_connection.py::test_gpt41_connection returned False, which will be an error in a future version of pytest.  Did you mean to use `assert` instead of `return`?
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=============================================== 1 passed, 1 warning in 0.31s ================================================


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python -m test_gpt41_connection

ğŸš€================================================ğŸš€
   GPT-4.1 Vision API Connection Test
ğŸš€================================================ğŸš€

==================================================
ğŸ”§ GPT-4.1 API Connection Test
==================================================

ğŸ“‹ Configuration:
  API Key: âŒ Not set
  Base URL: âŒ Not set
  Model: âŒ Not set

âŒ Missing configuration in .env file

ğŸ’¡ Required in .env:
   GPT4.1_API_KEY=your_key_here
   GPT4.1_BASE_URL=your_base_url_here
   GPT4.1_MODEL=openai/gpt-4.1

==================================================
ğŸ’” Test Result: FAIL

ğŸ‘‰ Fix .env file and try again
==================================================

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python test_gpt41.connetion.py
/Users/jay/.pyenv/versions/myenv/bin/python: can't open file '/Users/jay/ICT-projects/flownote-mvp/tests/test_gpt41.connetion.py': [Errno 2] No such file or directory


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_integration_onboarding_classification.py -v -s
==================================================== test session starts ====================================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collected 1 item                                                                                                            

test_integration_onboarding_classification.py::test_onboarding_to_classification FAILED

========================================================= FAILURES ==========================================================
_____________________________________________ test_onboarding_to_classification _____________________________________________

    def test_onboarding_to_classification():
        # 1. ì˜¨ë³´ë”©
        response = requests.post("http://localhost:8000/api/onboarding/initialize", json={
            "name": "TestUser",
            "occupation": "Developer",
            "areas": ["Python", "AI"],
            "projects": ["FlowNote"]
        })
>       user_id = response.json()["user_id"]        # <-- ì—¬ê¸°ì—ì„œë¶€í„° ì—ëŸ¬ ë°œìƒ
E       KeyError: 'user_id'

test_integration_onboarding_classification.py:24: KeyError
================================================== short test summary info ==================================================
FAILED test_integration_onboarding_classification.py::test_onboarding_to_classification - KeyError: 'user_id'
===================================================== 1 failed in 0.88s =====================================================


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python -m test_integration_onboarding_classification
(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python test_integration_onboarding_classification.py

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_metadata_integration.py -v -s
============================================== test session starts ===============================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collected 3 items                                                                                                

test_metadata_integration.py::test_metadata_with_auto_resolution PASSED: Metadata with auto resolution
PASSED
test_metadata_integration.py::test_metadata_with_conflict PASSED: Metadata with conflict
PASSED
test_metadata_integration.py::test_statistics PASSED: Statistics generation
PASSED

=============================================== 3 passed in 0.01s ================================================


=============================================== 3 passed in 0.01s ================================================
(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python -m test_metadata_integration
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_metadata_integration.py", line 4, in <module>
    from backend.classifier.conflict_resolver import ConflictResolver, ClassificationResult
ModuleNotFoundError: No module named 'backend'

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python test_metadata_integration.py
Traceback (most recent call last):
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_metadata_integration.py", line 4, in <module>
    from backend.classifier.conflict_resolver import ConflictResolver, ClassificationResult
ModuleNotFoundError: No module named 'backend'



(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_new_models.py -v -s
============================================== test session starts ===============================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collecting ... ==================================================
ìƒˆ API ëª¨ë¸ í…ŒìŠ¤íŠ¸
==================================================

1. Text-Embedding-3-Large í…ŒìŠ¤íŠ¸
--------------------------------------------------
âœ… ì„ë² ë”© ì„±ê³µ!
   - ëª¨ë¸: text-embedding-3-large
   - ë²¡í„° ì°¨ì›: 3072
   - í† í° ì‚¬ìš©: 16

2. Claude-4-Sonnet í…ŒìŠ¤íŠ¸
--------------------------------------------------
âœ… ì‘ë‹µ ì„±ê³µ!
   - ëª¨ë¸: anthropic/claude-sonnet-4
   - ì‘ë‹µ: FlowNoteì— ëŒ€í•œ êµ¬ì²´ì ì¸ ì •ë³´ê°€ ë¶€ì¡±í•˜ì—¬ ì •í™•í•œ ì„¤ëª…ì„ ë“œë¦¬ê¸° ì–´ë µìŠµë‹ˆë‹¤ë§Œ, ì¼ë°˜ì ìœ¼ë¡œ FlowNoteëŠ” ì›Œí¬í”Œë¡œìš° ê¸°ë°˜ì˜ ë…¸íŠ¸ ì‘ì„± ë° ë¬¸ì„œ ê´€ë¦¬ ë„êµ¬ë¡œ ì¶”ì •ë©ë‹ˆë‹¤.

ë” ì •í™•í•œ ì„¤ëª…ì„ 
   - í† í° ì‚¬ìš©: 129

3. Claude-3.5-Haiku í…ŒìŠ¤íŠ¸
--------------------------------------------------
âŒ ì—ëŸ¬: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

==================================================
í…ŒìŠ¤íŠ¸ ì™„ë£Œ!
==================================================
collected 0 items                                                                                                

============================================= no tests ran in 6.75s ==============================================

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python -m test_new_models
==================================================
ìƒˆ API ëª¨ë¸ í…ŒìŠ¤íŠ¸
==================================================

1. Text-Embedding-3-Large í…ŒìŠ¤íŠ¸
--------------------------------------------------
âœ… ì„ë² ë”© ì„±ê³µ!
   - ëª¨ë¸: text-embedding-3-large
   - ë²¡í„° ì°¨ì›: 3072
   - í† í° ì‚¬ìš©: 16

2. Claude-4-Sonnet í…ŒìŠ¤íŠ¸
--------------------------------------------------
âœ… ì‘ë‹µ ì„±ê³µ!
   - ëª¨ë¸: anthropic/claude-sonnet-4
   - ì‘ë‹µ: FlowNoteì— ëŒ€í•œ êµ¬ì²´ì ì¸ ì •ë³´ê°€ ë¶€ì¡±í•˜ì—¬ ì •í™•í•œ ì„¤ëª…ì„ ë“œë¦¬ê¸° ì–´ë µìŠµë‹ˆë‹¤ë§Œ, ì¼ë°˜ì ìœ¼ë¡œ ì´ëŸ° ì´ë¦„ì˜ ì„œë¹„ìŠ¤ëŠ” ì—…ë¬´ íë¦„ê³¼ ë…¸íŠ¸ ê¸°ëŠ¥ì„ ê²°í•©í•œ ìƒì‚°ì„± ë„êµ¬ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.

ë”
   - í† í° ì‚¬ìš©: 129

3. Claude-3.5-Haiku í…ŒìŠ¤íŠ¸
--------------------------------------------------
âŒ ì—ëŸ¬: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

==================================================
í…ŒìŠ¤íŠ¸ ì™„ë£Œ!
==================================================


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python test_new_models.py
==================================================
ìƒˆ API ëª¨ë¸ í…ŒìŠ¤íŠ¸
==================================================

1. Text-Embedding-3-Large í…ŒìŠ¤íŠ¸
--------------------------------------------------
âœ… ì„ë² ë”© ì„±ê³µ!
   - ëª¨ë¸: text-embedding-3-large
   - ë²¡í„° ì°¨ì›: 3072
   - í† í° ì‚¬ìš©: 16

2. Claude-4-Sonnet í…ŒìŠ¤íŠ¸
--------------------------------------------------
âœ… ì‘ë‹µ ì„±ê³µ!
   - ëª¨ë¸: anthropic/claude-sonnet-4
   - ì‘ë‹µ: FlowNoteëŠ” ì‚¬ìš©ìê°€ ìì—°ìŠ¤ëŸ½ê³  ì§ê´€ì ì¸ ë°©ì‹ìœ¼ë¡œ ì•„ì´ë””ì–´ë¥¼ ê¸°ë¡í•˜ê³  ì •ë¦¬í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ëœ ë…¸íŠ¸ ì‘ì„± ë„êµ¬ì…ë‹ˆë‹¤.
   - í† í° ì‚¬ìš©: 96

3. Claude-3.5-Haiku í…ŒìŠ¤íŠ¸
--------------------------------------------------
âŒ ì—ëŸ¬: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

==================================================
í…ŒìŠ¤íŠ¸ ì™„ë£Œ!
==================================================



(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_para_agent.py -v -s
============================================== test session starts ===============================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collecting ... âœ… ModelConfig loaded from backend.config
collected 3 items                                                                                                

test_para_agent.py::test_para_agent_flow 
======================================================================
ğŸš€ PARA Agent í…ŒìŠ¤íŠ¸ ì‹œì‘
======================================================================


Test 1: ì¶©ë¶„í•œ í…ìŠ¤íŠ¸ (ì •ìƒ ê²½ë¡œ)
----------------------------------------------------------------------
ğŸ“ Input Text: ì´ë²ˆ í”„ë¡œì íŠ¸ëŠ” ìƒˆë¡œìš´ ëŒ€ì‹œë³´ë“œ ê¸°ëŠ¥ì„ ê°œë°œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ë¥¼ ê°œì„ í•˜ê³  ì„±...
ğŸ“‹ Metadata: {'author': 'jay', 'date': '2025-11-02', 'priority': 'high'}

âœ… Result:
âŒ TEST FAILED - ì—ëŸ¬ ë°œìƒ: 'coroutine' object has no attribute 'get'

Test 2: ì§§ì€ í…ìŠ¤íŠ¸ (ì¬ë¶„ì„ ê²½ë¡œ)
----------------------------------------------------------------------
ğŸ“ Input Text: ê¸°íš
ğŸ“‹ Metadata: {'author': 'jay', 'date': '2025-11-02', 'category': 'project', 'department': 'product'}

âœ… Result:
âŒ TEST FAILED - ì—ëŸ¬ ë°œìƒ: 'coroutine' object has no attribute 'get'

Test 3: ì¤‘ê°„ ê¸¸ì´ í…ìŠ¤íŠ¸
----------------------------------------------------------------------
ğŸ“ Input Text: ë‹¤ìŒ ë¶„ê¸°ì˜ ë§ˆì¼€íŒ… ì „ëµì„ ê³„íší•´ì•¼ í•©ë‹ˆë‹¤
ğŸ“‹ Metadata: {'author': 'marketing_team', 'date': '2025-11-02'}

âœ… Result:
âŒ TEST FAILED - ì—ëŸ¬ ë°œìƒ: 'coroutine' object has no attribute 'get'

Test 4: ë§¤ìš° ì§§ì€ í…ìŠ¤íŠ¸ (ì¬ë¶„ì„ í•„ìš”)
----------------------------------------------------------------------
ğŸ“ Input Text: ì•„
ğŸ“‹ Metadata: {'author': 'jay', 'date': '2025-11-02', 'type': 'resource'}

âœ… Result:
âŒ TEST FAILED - ì—ëŸ¬ ë°œìƒ: 'coroutine' object has no attribute 'get'

Test 5: ë¹ˆ ë©”íƒ€ë°ì´í„°
----------------------------------------------------------------------
ğŸ“ Input Text: ì´ ë¬¸ì„œëŠ” í•™ìŠµ ìë£Œì…ë‹ˆë‹¤. íŒŒì´ì¬ í”„ë¡œê·¸ë˜ë°ì— ëŒ€í•œ ê¸°ì´ˆ ê°œë…ì„ ì„¤ëª…í•©ë‹ˆë‹¤.
ğŸ“‹ Metadata: {}

âœ… Result:
âŒ TEST FAILED - ì—ëŸ¬ ë°œìƒ: 'coroutine' object has no attribute 'get'

======================================================================
ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼: 0 í†µê³¼, 5 ì‹¤íŒ¨
======================================================================
PASSED
test_para_agent.py::test_graph_structure 
======================================================================
ğŸ“ Graph êµ¬ì¡° ê²€ì¦
======================================================================

âœ… Graph ìƒì„± ì„±ê³µ
   - Type: <class 'langgraph.graph.state.CompiledStateGraph'>
âœ… Graph ì»´íŒŒì¼ ì™„ë£Œ
PASSED
test_para_agent.py::test_path_routing 
======================================================================
ğŸ”€ ê²½ë¡œ ë¼ìš°íŒ… í…ŒìŠ¤íŠ¸
======================================================================

1ï¸âƒ£ ì •ìƒ ê²½ë¡œ (í…ìŠ¤íŠ¸ ì¶©ë¶„):
FAILED

==================================================== FAILURES ====================================================
_______________________________________________ test_path_routing ________________________________________________

    def test_path_routing():
        """ì •ìƒ/ì¬ë¶„ì„ ê²½ë¡œ ë¶„ê¸° í…ŒìŠ¤íŠ¸"""
        print("\n" + "="*70)
        print("ğŸ”€ ê²½ë¡œ ë¼ìš°íŒ… í…ŒìŠ¤íŠ¸")
        print("="*70 + "\n")
    
        # ì •ìƒ ê²½ë¡œ í…ŒìŠ¤íŠ¸
        print("1ï¸âƒ£ ì •ìƒ ê²½ë¡œ (í…ìŠ¤íŠ¸ ì¶©ë¶„):")
        text_normal = "í”„ë¡œì íŠ¸ ê¸°íš ë¬¸ì„œì…ë‹ˆë‹¤. ë§¤ìš° ìƒì„¸í•œ ë‚´ìš©ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤."
        result_normal = run_para_agent(text=text_normal, metadata={})
>       print(f"   âœ… ì™„ë£Œ: {result_normal.get('category', 'N/A')}")
E       AttributeError: 'coroutine' object has no attribute 'get'

test_para_agent.py:148: AttributeError
================================================ warnings summary ================================================
test_para_agent.py::test_para_agent_flow
  /Users/jay/ICT-projects/flownote-mvp/tests/test_para_agent.py:94: RuntimeWarning: coroutine 'run_para_agent' was never awaited
    result = run_para_agent(text=text, metadata=metadata)
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

test_para_agent.py::test_para_agent_flow
  /Users/jay/.pyenv/versions/3.11.10/envs/myenv/lib/python3.11/site-packages/_pytest/python.py:159: RuntimeWarning: coroutine 'run_para_agent' was never awaited
    result = testfunction(**testargs)
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

test_para_agent.py::test_para_agent_flow
  /Users/jay/.pyenv/versions/3.11.10/envs/myenv/lib/python3.11/site-packages/_pytest/python.py:163: PytestReturnNotNoneWarning: Expected None, but test_para_agent.py::test_para_agent_flow returned (0, 5), which will be an error in a future version of pytest.  Did you mean to use `assert` instead of `return`?
    warnings.warn(

test_para_agent.py::test_graph_structure
  /Users/jay/.pyenv/versions/3.11.10/envs/myenv/lib/python3.11/site-packages/_pytest/python.py:163: PytestReturnNotNoneWarning: Expected None, but test_para_agent.py::test_graph_structure returned True, which will be an error in a future version of pytest.  Did you mean to use `assert` instead of `return`?
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
============================================ short test summary info =============================================
FAILED test_para_agent.py::test_path_routing - AttributeError: 'coroutine' object has no attribute 'get'
==================================== 1 failed, 2 passed, 4 warnings in 0.69s =====================================
sys:1: RuntimeWarning: coroutine 'run_para_agent' was never awaited



(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python -m test_para_agent
âœ… ModelConfig loaded from backend.config

ğŸ¯ LangGraph PARA Agent í†µí•© í…ŒìŠ¤íŠ¸


======================================================================
ğŸ“ Graph êµ¬ì¡° ê²€ì¦
======================================================================

âœ… Graph ìƒì„± ì„±ê³µ
   - Type: <class 'langgraph.graph.state.CompiledStateGraph'>
âœ… Graph ì»´íŒŒì¼ ì™„ë£Œ

======================================================================
ğŸ”€ ê²½ë¡œ ë¼ìš°íŒ… í…ŒìŠ¤íŠ¸
======================================================================

1ï¸âƒ£ ì •ìƒ ê²½ë¡œ (í…ìŠ¤íŠ¸ ì¶©ë¶„):
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_para_agent.py", line 187, in <module>
    main()
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_para_agent.py", line 169, in main
    test_path_routing()
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_para_agent.py", line 148, in test_path_routing
    print(f"   âœ… ì™„ë£Œ: {result_normal.get('category', 'N/A')}")
                         ^^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'get'
sys:1: RuntimeWarning: coroutine 'run_para_agent' was never awaited


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python test_para_agent.py
âœ… ModelConfig loaded from backend.config

ğŸ¯ LangGraph PARA Agent í†µí•© í…ŒìŠ¤íŠ¸


======================================================================
ğŸ“ Graph êµ¬ì¡° ê²€ì¦
======================================================================

âœ… Graph ìƒì„± ì„±ê³µ
   - Type: <class 'langgraph.graph.state.CompiledStateGraph'>
âœ… Graph ì»´íŒŒì¼ ì™„ë£Œ

======================================================================
ğŸ”€ ê²½ë¡œ ë¼ìš°íŒ… í…ŒìŠ¤íŠ¸
======================================================================

1ï¸âƒ£ ì •ìƒ ê²½ë¡œ (í…ìŠ¤íŠ¸ ì¶©ë¶„):
Traceback (most recent call last):
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_para_agent.py", line 187, in <module>
    main()
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_para_agent.py", line 169, in main
    test_path_routing()
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_para_agent.py", line 148, in test_path_routing
    print(f"   âœ… ì™„ë£Œ: {result_normal.get('category', 'N/A')}")
                         ^^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'get'
sys:1: RuntimeWarning: coroutine 'run_para_agent' was never awaited


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_para_classifier.py -v -s
============================================== test session starts ===============================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collecting ... âœ… ModelConfig loaded from backend.config
collected 1 item                                                                                                 

test_para_classifier.py::test_classifier ==================================================
PARA ë¶„ë¥˜ í…ŒìŠ¤íŠ¸
==================================================
FAILED

==================================================== FAILURES ====================================================
________________________________________________ test_classifier _________________________________________________

    def test_classifier():
        """ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸"""
    
        classifier = PARAClassifier()
    
        # í…ŒìŠ¤íŠ¸ íŒŒì¼ë“¤
        test_files = [
            {
                "filename": "í”„ë¡œì íŠ¸_ì œì•ˆì„œ.pdf",
                "content": "2025ë…„ ì‹ ê·œ í”„ë¡œì íŠ¸ ì œì•ˆì„œ. ë§ˆê°: 11ì›” 15ì¼"
            },
            {
                "filename": "Python_í•™ìŠµë…¸íŠ¸.md",
                "content": "íŒŒì´ì¬ ë¬¸ë²• ì •ë¦¬. ì§€ì†ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ ì¤‘."
            },
            {
                "filename": "AI_ë…¼ë¬¸_ëª¨ìŒ.pdf",
                "content": "ì°¸ê³ ìš© AI ê´€ë ¨ ë…¼ë¬¸ ëª¨ìŒì§‘"
            },
            {
                "filename": "2024_ì™„ë£Œ_í”„ë¡œì íŠ¸.pdf",
                "content": "2024ë…„ì— ì™„ë£Œëœ í”„ë¡œì íŠ¸ ìµœì¢… ë³´ê³ ì„œ"
            }
        ]
    
        print("=" * 50)
        print("PARA ë¶„ë¥˜ í…ŒìŠ¤íŠ¸")
        print("=" * 50)
    
        for test_file in test_files:
>           result = classifier.classify(
                test_file["filename"],
                test_file["content"]
            )
E           AttributeError: 'PARAClassifier' object has no attribute 'classify'

test_para_classifier.py:42: AttributeError
============================================ short test summary info =============================================
FAILED test_para_classifier.py::test_classifier - AttributeError: 'PARAClassifier' object has no attribute 'classify'
=============================================== 1 failed in 0.65s ================================================

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python -m test_para_classifier
âœ… ModelConfig loaded from backend.config
==================================================
PARA ë¶„ë¥˜ í…ŒìŠ¤íŠ¸
==================================================
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_para_classifier.py", line 54, in <module>
    test_classifier()
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_para_classifier.py", line 42, in test_classifier
    result = classifier.classify(
             ^^^^^^^^^^^^^^^^^^^
AttributeError: 'PARAClassifier' object has no attribute 'classify'

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python test_para_classifier.py 
âœ… ModelConfig loaded from backend.config
==================================================
PARA ë¶„ë¥˜ í…ŒìŠ¤íŠ¸
==================================================
Traceback (most recent call last):
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_para_classifier.py", line 54, in <module>
    test_classifier()
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_para_classifier.py", line 42, in test_classifier
    result = classifier.classify(
             ^^^^^^^^^^^^^^^^^^^
AttributeError: 'PARAClassifier' object has no attribute 'classify'


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_prompt_conflict.py -v -s
============================================== test session starts ===============================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collecting ... âœ… ModelConfig loaded from backend.config
collected 1 item                                                                                                 

test_prompt_conflict.py::test_prompt_conflict FAILED

==================================================== FAILURES ====================================================
______________________________________________ test_prompt_conflict ______________________________________________

    def test_prompt_conflict():
        # 1. ì¶©ëŒ ìƒí™© ìƒì„±
        response = requests.post("http://localhost:8000/api/classify", json={
            "text": "Python íŠœí† ë¦¬ì–¼",  # ì• ë§¤í•œ ì¼€ì´ìŠ¤
            "user_id": "test_user"
        })
        result = response.json()
    
        # 2. ì¶©ëŒ í•´ê²° ê²€ì¦
>       assert "conflict_details" in result, "ì¶©ëŒ ì •ë³´ ì—†ìŒ"
E       AssertionError: ì¶©ëŒ ì •ë³´ ì—†ìŒ
E       assert 'conflict_details' in {'detail': 'Not Found'}

test_prompt_conflict.py:28: AssertionError
============================================ short test summary info =============================================
FAILED test_prompt_conflict.py::test_prompt_conflict - AssertionError: ì¶©ëŒ ì •ë³´ ì—†ìŒ
=============================================== 1 failed in 0.68s ================================================

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python -m test_prompt_conflict 
âœ… ModelConfig loaded from backend.config
(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python test_prompt_conflict.py
âœ… ModelConfig loaded from backend.config


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_validators.py -v -s
============================================== test session starts ===============================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collecting ... âŒ API í‚¤ ê²€ì¦ ì‹¤íŒ¨: âŒ config íŒŒì¼ ì„í¬íŠ¸ ì‹¤íŒ¨: cannot import name 'EMBEDDING_API_KEY' from 'backend.config' (/Users/jay/ICT-projects/flownote-mvp/backend/config.py)
collected 0 items                                                                                                

============================================= no tests ran in 0.27s ==============================================

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python -m test_validators
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_validators.py", line 2, in <module>
    from backend.validators import APIKeyValidator
ModuleNotFoundError: No module named 'backend'

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python test_validators.py
Traceback (most recent call last):
  File "/Users/jay/ICT-projects/flownote-mvp/tests/test_validators.py", line 2, in <module>
    from backend.validators import APIKeyValidator
ModuleNotFoundError: No module named 'backend'


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— pytest test_vision_helper.py -v -s
============================================== test session starts ===============================================
platform darwin -- Python 3.11.10, pytest-8.3.0, pluggy-1.6.0 -- /Users/jay/.pyenv/versions/3.11.10/envs/myenv/bin/python
cachedir: .pytest_cache
rootdir: /Users/jay/ICT-projects/flownote-mvp/tests
plugins: anyio-4.11.0, langsmith-0.4.37
collected 8 items                                                                                                

test_vision_helper.py::TestVisionCodeGenerator::test_generator_initialization âœ… Generator ì´ˆê¸°í™” ì„±ê³µ!
PASSED
test_vision_helper.py::TestVisionCodeGenerator::test_model_name_is_gpt41 âœ… ì‚¬ìš© ëª¨ë¸: openai/gpt-4.1
PASSED
test_vision_helper.py::TestVisionCodeGenerator::test_encode_image_file_not_found âœ… íŒŒì¼ ì—†ìŒ ì—ëŸ¬ ì²˜ë¦¬ ì™„ë²½!
PASSED
test_vision_helper.py::TestVisionCodeGenerator::test_encode_image_with_valid_file âœ… ì´ë¯¸ì§€ ì¸ì½”ë”© ì„±ê³µ! (í¬ê¸°: 82484 bytes)
PASSED
test_vision_helper.py::TestVisionCodeGenerator::test_generate_streamlit_code_file_not_found âœ… ì—ëŸ¬ ì²˜ë¦¬ ë°˜í™˜ê°’ ì™„ë²½!
PASSED
test_vision_helper.py::TestVisionCodeGenerator::test_generate_streamlit_code_response_structure âœ… ì‘ë‹µ êµ¬ì¡° ì™„ë²½!
PASSED
test_vision_helper.py::TestVisionCodeGenerator::test_extract_streamlit_components âœ… ì»´í¬ë„ŒíŠ¸ ì¶”ì¶œ ì™„ë²½! ['st.button', 'st.slider', 'st.text_input', 'st.title']
PASSED
test_vision_helper.py::TestVisionCodeGenerator::test_generate_from_url_response_structure âš ï¸ URL ê¸°ë°˜ í…ŒìŠ¤íŠ¸ëŠ” API ë¹„ìš©ìœ¼ë¡œ ì¸í•´ ìŠ¤í‚µë¨ (í•„ìš”ì‹œ ìˆ˜ë™ ì‹¤í–‰)
PASSED

===================================================== 8 passed in 21.89s ======================================================

(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python -m test_vision_helper

============================================================
ğŸ”¥ VisionCodeGenerator ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ì‹œì‘!
============================================================

[1ï¸âƒ£] Generator ì´ˆê¸°í™”...
âœ… ì„±ê³µ! ëª¨ë¸: openai/gpt-4.1

[2ï¸âƒ£] íŒŒì¼ ì—†ìŒ ì—ëŸ¬ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸...
âœ… ì„±ê³µ! ì—ëŸ¬ ë©”ì‹œì§€: ì´ë¯¸ì§€ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: fake.png

[3ï¸âƒ£] ì»´í¬ë„ŒíŠ¸ ì¶”ì¶œ í…ŒìŠ¤íŠ¸...
âœ… ì„±ê³µ! ì¶”ì¶œëœ ì»´í¬ë„ŒíŠ¸: ['st.button', 'st.slider']

[4ï¸âƒ£] í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ í™•ì¸...
âœ… í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ ì¡´ì¬: /Users/jay/ICT-projects/flownote-mvp/tests/test_images/test.png
   â†’ ì‹¤ì œ API í…ŒìŠ¤íŠ¸ ê°€ëŠ¥!

============================================================
ğŸ‰ ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ì™„ë£Œ!
============================================================


(myenv) âœ  tests git:(refactor-v4-phase-1-baseline) âœ— python test_vision_helper.py

============================================================
ğŸ”¥ VisionCodeGenerator ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ì‹œì‘!
============================================================

[1ï¸âƒ£] Generator ì´ˆê¸°í™”...
âœ… ì„±ê³µ! ëª¨ë¸: openai/gpt-4.1

[2ï¸âƒ£] íŒŒì¼ ì—†ìŒ ì—ëŸ¬ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸...
âœ… ì„±ê³µ! ì—ëŸ¬ ë©”ì‹œì§€: ì´ë¯¸ì§€ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: fake.png

[3ï¸âƒ£] ì»´í¬ë„ŒíŠ¸ ì¶”ì¶œ í…ŒìŠ¤íŠ¸...
âœ… ì„±ê³µ! ì¶”ì¶œëœ ì»´í¬ë„ŒíŠ¸: ['st.button', 'st.slider']

[4ï¸âƒ£] í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ í™•ì¸...
âœ… í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ ì¡´ì¬: /Users/jay/ICT-projects/flownote-mvp/tests/test_images/test.png
   â†’ ì‹¤ì œ API í…ŒìŠ¤íŠ¸ ê°€ëŠ¥!

============================================================
ğŸ‰ ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ì™„ë£Œ!
============================================================